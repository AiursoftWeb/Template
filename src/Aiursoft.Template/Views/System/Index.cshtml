@using System.Diagnostics
@{
    var process = Process.GetCurrentProcess();
}

<h1 class="mt-4">System Information</h1>
<p class="text-muted">Detailed information about the current server environment and request context.</p>

<div class="container mt-4" id="functions">
    <div class="row no-gutters">
        <div class="col-sm-12 px-1">
            <div class="card mb-2 tests-card">
                <div class="card-body">
                    <h5 class="card-title">Request HTTP Headers (From server's view)</h5>
                    <div class="table-responsive">
                        <table class="table table-striped table-hover table-sm">
                            <tr>
                                <th>Header</th>
                                <th>Value</th>
                            </tr>
                            @foreach (var item in Context.Request.Headers)
                            {
                                <tr>
                                    <td>@item.Key</td>
                                    <td>@item.Value.ToString().SafeSubstring(200)</td>
                                </tr>
                            }
                        </table>
                    </div>

                    <h5 class="card-title">Request other properties</h5>
                    <div class="table-responsive">
                        <table class="table table-striped table-hover table-sm">
                            <tr>
                                <th>Name</th>
                                <th>Value</th>
                            </tr>
                            <tr>
                                <td>Host</td>
                                <td>@Context.Request.Host</td>
                            </tr>
                            <tr>
                                <td>Port</td>
                                <td>@Context.Connection.LocalPort</td>
                            </tr>
                            <tr>
                                <td>Path</td>
                                <td>@Context.Request.Path</td>
                            </tr>
                            <tr>
                                <td>Method</td>
                                <td>@Context.Request.Method</td>
                            </tr>
                            <tr>
                                <td>Protocol</td>
                                <td>@Context.Request.Protocol</td>
                            </tr>
                            <tr>
                                <td>Scheme</td>
                                <td>@Context.Request.Scheme</td>
                            </tr>
                            <tr>
                                <td>IP</td>
                                <td>@Context.Connection.RemoteIpAddress?.ToString()</td>
                            </tr>
                            <tr>
                                <td>Request Port</td>
                                <td>@Context.Connection.RemotePort</td>
                            </tr>
                            <tr>
                                <td>Is HTTPS</td>
                                <td>@Context.Request.IsHttps</td>
                            </tr>
                        </table>
                    </div>

                    <h5 class="card-title">Server Information</h5>
                    <div class="table-responsive">
                        <table class="table table-striped table-hover table-sm">
                            <tr>
                                <th>Name</th>
                                <th>Value</th>
                            </tr>
                            <tr>
                                <td class="w-25">System</td>
                                <td>@Aiursoft.CSTools.Services.OperatingSystemExtensions.TryGetFullOsVersion() @(Environment.Is64BitOperatingSystem ? "(64-bit)" : "(32-bit)")</td>
                            </tr>
                            <tr>
                                <td>Directory</td>
                                <td>@Environment.CurrentDirectory</td>
                            </tr>
                            <tr>
                                <td>Machine Name</td>
                                <td>@Environment.MachineName</td>
                            </tr>
                            <tr>
                                <td>User Name</td>
                                <td>@Environment.UserDomainName\@Environment.UserName</td>
                            </tr>
                            <tr>
                                <td>.NET Version</td>
                                <td>@Environment.Version</td>
                            </tr>
                            <tr>
                                <td>Worker Process</td>
                                <td>[@process.Id] @process.ProcessName @(Environment.Is64BitProcess ? "(64-bit)" : "(32-bit)")</td>
                            </tr>
                            <tr>
                                <td>Start Time</td>
                                <td>@process.StartTime.ToUniversalTime() (UTC)</td>
                            </tr>
                            <tr>
                                <td>Memory</td>
                                <td>@(process.WorkingSet64 / 1024 / 1024) MB</td>
                            </tr>
                            <tr>
                                <td>Docker Container</td>
                                <td>@(Environment.GetEnvironmentVariable("DOTNET_RUNNING_IN_CONTAINER") == "true")</td>
                            </tr>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
